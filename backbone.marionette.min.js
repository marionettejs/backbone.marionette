// Backbone.Marionette v0.2.0
//
// Copyright (C)2011 Derick Bailey, Muted Solutions, LLC
// Distributed Under MIT License
//
// Documentation and Full License Available at:
// http://github.com/derickbailey/backbone.marionette
Backbone.Marionette=function(d,c,e){var b={version:"0.2.0",RegionManager:function(a){this.options=a||{};if(!this.el)throw Error("An 'el' must be specified");this.el=e(this.el)}};c.extend(b.RegionManager.prototype,d.Events,{show:function(a){var f=this.currentView;this.currentView=a;this._closeView(f);this._openView(a)},_closeView:function(a){a&&a.close&&a.close()},_openView:function(a){a.render();this.el.html(a.el);if(a.onShow)a.onShow()}});b.ItemView=d.View.extend({serializeData:function(){var a;
if(this.collection)a={},a.items=this.collection.toJSON();this.model&&(a=this.model.toJSON());return a},template:function(){return e(this.options.template)},render:function(){var a;a=this.template;a=(c.isFunction(a)?a.call(this):e(a)).html();var f=this.serializeData();a=this.renderTemplate(a,f);e(this.el).html(a);if(this.onRender)this.onRender()},renderTemplate:function(a,f){return c.template(a,f)},close:function(){this.unbindAll();this.unbind();this.remove();if(this.onClose)this.onClose()}});b.CollectionView=
d.View.extend({render:function(){var a=this,f=e(this.el);this.collection.each(function(b){b=a.renderItem(b);a.appendHtml(f,b)})},appendHtml:function(a,b){a.append(b)},renderItem:function(a){a=new this.itemView({model:a});a.render();this.storeChild(a);return a.el},close:function(){this.unbind();this.unbindAll();this.remove();this.children&&c.each(this.children,function(a){a.close()});if(this.onClose)this.onClose()},storeChild:function(a){if(!this.children)this.children=[];this.children.push(a)}});
b.BindTo={bindTo:function(a,b,c,d){d=d||this;a.bind(b,c,d);if(!this.bindings)this.bindings=[];this.bindings.push({obj:a,eventName:b,callback:c,context:d})},unbindAll:function(){c.each(this.bindings,function(a){a.obj.unbind(a.eventName,a.callback)});this.bindings=[]}};b.Application=function(a){this.initializers=[];this.vent=c.extend({},d.Events);c.extend(this,a)};c.extend(b.Application.prototype,d.Events,{addInitializer:function(a){this.initializers.push(a)},start:function(a){this.trigger("initialize:before",
a);for(var b=0;b<this.initializers.length;b++)(0,this.initializers[b])(a);this.trigger("initialize:after",a)},addRegions:function(a){if(!this.regions)this.regions={},this.addInitializer(c.bind(this._initializeRegions,this));var d=this.regions,e;for(e in a)a.hasOwnProperty(e)&&(regionValue=a[e],d[e]="string"===typeof regionValue?b.RegionManager.extend({el:regionValue}):regionValue)},_initializeRegions:function(){if(this.regions)for(var a in this.regions)this.regions.hasOwnProperty(a)&&(this[a]=new this.regions[a])}});
var g=d.View.extend;b.RegionManager.extend=g;b.Application.extend=g;c.extend(b.ItemView.prototype,b.BindTo);c.extend(b.CollectionView.prototype,b.BindTo);c.extend(b.Application.prototype,b.BindTo);return b}(Backbone,_,jQuery);
