// MarionetteJS (Backbone.Marionette)
// ----------------------------------
// v3.0.0-pre.3
//
// Copyright (c)2016 Derick Bailey, Muted Solutions, LLC.
// Distributed under MIT license
//
// http://marionettejs.com
/*!
* Includes BabySitter
* https://github.com/marionettejs/backbone.babysitter/
*
* Includes Radio
* https://github.com/marionettejs/backbone.radio/
*/
// Copyright (c)2016 Derick Bailey, Muted Solutions, LLC.
// Distributed under MIT license
//
// http://github.com/marionettejs/backbone.babysitter
!function(e,t){"use strict";var i=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var i=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(i.prototype,{add:function(e,t){var i=e.cid;return this._views[i]=e,e.model&&(this._indexByModel[e.model.cid]=i),t&&(this._indexByCustom[t]=i),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var i=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===i?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[i],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,i){t.each(this._views,function(n){t.isFunction(n[e])&&n[e].apply(n,i||[])})},_updateLength:function(){this.length=t.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(n,function(e){i.prototype[e]=function(){var i=t.values(this._views),n=[i].concat(t.toArray(arguments));return t[e].apply(t,n)}}),i}(e,t),e.ChildViewContainer.VERSION="1.0.0-pre.1",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=i,this},e.ChildViewContainer}(Backbone,_),function(e,t){"use strict";function i(e,t,i,n){var r=e[t];return i&&i!==r.callback&&i!==r.callback._callback||n&&n!==r.context?void 0:(delete e[t],!0)}function n(t,n,r,s){t||(t={});for(var o=n?[n]:e.keys(t),h=!1,a=0,l=o.length;l>a;a++)n=o[a],t[n]&&i(t,n,r,s)&&(h=!0);return h}function r(t){return d[t]||(d[t]=e.partial(a.log,t))}function s(t){return e.isFunction(t)?t:function(){return t}}e="default"in e?e["default"]:e,t="default"in t?t["default"]:t;var o={};o["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};var h=t.Radio,a=t.Radio={};a.VERSION="2.0.0-pre.1",a.noConflict=function(){return t.Radio=h,this},a.DEBUG=!1,a._debugText=function(e,t,i){return e+(i?" on the "+i+" channel":"")+': "'+t+'"'},a.debugLog=function(e,t,i){a.DEBUG&&console&&console.warn&&console.warn(a._debugText(e,t,i))};var l=/\s+/;a._eventsApi=function(t,i,n,r){if(!n)return!1;var s={};if("object"===("undefined"==typeof n?"undefined":o["typeof"](n))){for(var h in n){var a=t[i].apply(t,[h,n[h]].concat(r));l.test(h)?e.extend(s,a):s[h]=a}return s}if(l.test(n)){for(var d=n.split(l),c=0,u=d.length;u>c;c++)s[d[c]]=t[i].apply(t,[d[c]].concat(r));return s}return!1},a._callHandler=function(e,t,i){var n=i[0],r=i[1],s=i[2];switch(i.length){case 0:return e.call(t);case 1:return e.call(t,n);case 2:return e.call(t,n,r);case 3:return e.call(t,n,r,s);default:return e.apply(t,i)}};var d={};e.extend(a,{log:function(t,i){if("undefined"!=typeof console){var n=e.drop(arguments,2);console.log("["+t+'] "'+i+'"',n)}},tuneIn:function(e){var t=a.channel(e);return t._tunedIn=!0,t.on("all",r(e)),this},tuneOut:function(e){var t=a.channel(e);return t._tunedIn=!1,t.off("all",r(e)),delete d[e],this}}),a.Requests={request:function(t){var i=e.rest(arguments),n=a._eventsApi(this,"request",t,i);if(n)return n;var r=this.channelName,s=this._requests;if(r&&this._tunedIn&&a.log.apply(this,[r,t].concat(i)),s&&(s[t]||s["default"])){var o=s[t]||s["default"];return i=s[t]?i:arguments,a._callHandler(o.callback,o.context,i)}a.debugLog("An unhandled request was fired",t,r)},reply:function(e,t,i){return a._eventsApi(this,"reply",e,[t,i])?this:(this._requests||(this._requests={}),this._requests[e]&&a.debugLog("A request was overwritten",e,this.channelName),this._requests[e]={callback:s(t),context:i||this},this)},replyOnce:function(t,i,n){if(a._eventsApi(this,"replyOnce",t,[i,n]))return this;var r=this,o=e.once(function(){return r.stopReplying(t),s(i).apply(this,arguments)});return this.reply(t,o,n)},stopReplying:function(e,t,i){return a._eventsApi(this,"stopReplying",e)?this:(e||t||i?n(this._requests,e,t,i)||a.debugLog("Attempted to remove the unregistered request",e,this.channelName):delete this._requests,this)}},a._channels={},a.channel=function(e){if(!e)throw new Error("You must provide a name for the channel.");return a._channels[e]?a._channels[e]:a._channels[e]=new a.Channel(e)},a.Channel=function(e){this.channelName=e},e.extend(a.Channel.prototype,t.Events,a.Requests,{reset:function(){return this.off(),this.stopListening(),this.stopReplying(),this}});var c,u,f=[t.Events,a.Requests];return e.each(f,function(t){e.each(t,function(t,i){a[i]=function(t){return u=e.rest(arguments),c=this.channel(t),c[i].apply(c,u)}})}),a.reset=function(t){var i=t?[this._channels[t]]:this._channels;e.invoke(i,"reset")},a}(_,Backbone);var Marionette=global.Mn=function(e,t,i,n){"use strict";function r(e,t,i){return i.toUpperCase()}function s(e){for(var i,n="on"+e.replace(k,r),s=T.call(this,n),o=arguments.length,h=Array(o>1?o-1:0),a=1;o>a;a++)h[a-1]=arguments[a];return t.isFunction(s)&&(i=s.apply(this,h)),this.trigger.apply(this,[e].concat(h)),i}function o(e){for(var i=t.isFunction(e.triggerMethod)?e.triggerMethod:s,n=arguments.length,r=Array(n>1?n-1:0),o=1;n>o;o++)r[o-1]=arguments[o];return i.apply(e,r)}function h(e,i,n){e._getImmediateChildren&&t.each(e._getImmediateChildren(),function(e){n&&n(e),o(e,i,e)})}function a(e){e._isAttached=!0}function l(e){e._isAttached=!1}function d(e){function t(){h(e,"before:attach")}function i(){h(e,"attach",a),d()}function n(){h(e,"before:detach")}function r(){h(e,"detach",l)}function s(){d()}function d(){e._isAttached&&e._isRendered&&o(e,"dom:refresh",e)}e._areViewEventsMonitored||(e._areViewEventsMonitored=!0,e.on({"before:attach":t,attach:i,"before:detach":n,detach:r,render:s}))}function c(e,i,n,r,s){var o=r.split(/\s+/);t.each(o,function(t){var r=e[t];if(!r)throw new L('Method "'+t+'" was configured as an event handler, but does not exist.');e[s](i,n,r)})}function u(e,i,n,r){if(i&&n){if(!t.isObject(n))throw new L({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindentityevents"});t.each(n,function(n,s){return t.isString(n)?void c(e,i,s,n,r):void e[r](i,s,n)})}}function f(e,t){u(this,e,t,"listenTo")}function g(e,t){u(this,e,t,"stopListening")}function p(e,i,n,r){if(i&&n){if(!t.isObject(n))throw new L({message:"Bindings must be an object.",url:"marionette.functions.html#marionettebindradiorequests"});var s=D.call(e,n);i[r](s,e)}}function _(e,t){p(this,e,t,"reply")}function v(e,t){p(this,e,t,"stopReplying")}function y(e,i){return e.behaviorClass?e.behaviorClass:t.isFunction(e)?e:S(fe.Behaviors.behaviorsLookup,e,i)[i]}function m(e,i){return t.chain(i).map(function(i,n){var r=y(i,n),s=i===r?{}:i,o=new r(s,e),h=m(e,t.result(o,"behaviors"));return[o].concat(h)}).flatten().value()}function w(e,i){return[e+t.uniqueId(".evt"),i].join(" ")}function E(e,i){t.isString(i)&&(i={event:i});var n=i.event,r=i.preventDefault!==!1,s=i.stopPropagation!==!1;return function(t){r&&t.preventDefault(),s&&t.stopPropagation(),e.triggerMethod(n,e)}}function b(e){e.supportsDestroyLifecycle||o(e,"before:destroy",e);var t=!!e._isAttached;t&&o(e,"before:detach",e),e.remove(),t&&(e._isAttached=!1,o(e,"detach",e)),e._isDestroyed=!0,e.supportsDestroyLifecycle||o(e,"destroy",e)}function V(){throw new L({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.md#behaviorslookup"})}function C(e){return!!ce[e]}function R(e,t){return ce[e]=t}e="default"in e?e["default"]:e,t="default"in t?t["default"]:t,i="default"in i?i["default"]:i,n="default"in n?n["default"]:n;var M={};M.toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)};var x="3.0.0-pre.3",B=function(e){return function(t){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;i>r;r++)n[r-1]=arguments[r];return e.apply(t,n)}},O=e.Model.extend,A=function(t){return e.$.contains(document.documentElement,t)},I=function(e,i){e&&t.extend(this,t.pick(e,i))},T=function(e){return e?this.options&&void 0!==this.options[e]?this.options[e]:this[e]:void 0},D=function(e){var i=this;return t.reduce(e,function(e,n,r){return t.isFunction(n)||(n=i[n]),n&&(e[r]=n),e},{})},U=function ge(e,i){t.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),fe.DEV_MODE&&(void 0!==i&&i||ge._cache[e]||(ge._warn("Deprecation warning: "+e),ge._cache[e]=!0))};U._console="undefined"!=typeof console?console:{},U._warn=function(){var e=U._console.warn||U._console.log||function(){};return e.apply(U._console,arguments)},U._cache={};var k=/(^|:)(\w)/gi,S=function(e){if(t.isFunction(e)){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;i>r;r++)n[r-1]=arguments[r];return e.apply(this,n)}return e},$=function(){for(var e=arguments.length,i=Array(e),n=0;e>n;n++)i[n]=arguments[n];this.options=t.extend.apply(t,[{},t.result(this,"options")].concat(i))},F=["description","fileName","lineNumber","name","message","number"],L=O.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+x+"/",constructor:function(e,i){t.isObject(e)?(i=e,e=i.message):i||(i={});var n=Error.call(this,e);t.extend(this,t.pick(n,F),t.pick(i,F)),this.captureStackTrace(),i.url&&(this.url=this.urlRoot+i.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,L)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}});L.extend=O;var q={getValue:S,normalizeMethods:D,_setOptions:$,mergeOptions:I,getOption:T,bindEntityEvents:f,unbindEntityEvents:g},z={_initRadio:function(){var e=this.getValue(this.getOption("channelName"));if(e){var t=this._channel=i.channel(e),n=this.getValue(this.getOption("radioEvents"));this.bindRadioEvents(t,n);var r=this.getValue(this.getOption("radioRequests"));this.bindRadioRequests(t,r),this.on("destroy",this._destroyRadio)}},_destroyRadio:function(){this._channel.stopReplying(null,null,this)},getChannel:function(){return this._channel},bindRadioEvents:f,unbindRadioEvents:g,bindRadioRequests:_,unbindRadioRequests:v},P=function(e){this._setOptions(e),this.cid=t.uniqueId(this.cidPrefix),this._initRadio(),this.initialize.apply(this,arguments)};P.extend=O,t.extend(P.prototype,e.Events,q,z,{cidPrefix:"mno",_isDestroyed:!1,isDestroyed:function(){return this._isDestroyed},initialize:function(){},destroy:function(){if(this._isDestroyed)return this;for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this._isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.stopListening(),this},triggerMethod:s});var j=function(e){this.templateId=e};t.extend(j,{templateCaches:{},get:function(e,t){var i=this.templateCaches[e];return i||(i=new j(e),this.templateCaches[e]=i),i.load(t)},clear:function(){for(var e,t=arguments.length,i=Array(t),n=0;t>n;n++)i[n]=arguments[n];var r=i.length;if(r>0)for(e=0;r>e;e++)delete this.templateCaches[i[e]];else this.templateCaches={}}}),t.extend(j.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(t,i){var n=e.$(t);if(!n.length)throw new L({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return n.html()},compileTemplate:function(e,i){return t.template(e,i)}});var N={render:function(e,i){if(!e)throw new L({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n=t.isFunction(e)?e:j.get(e);return n(i)}},H=t.invokeMap||t.invoke,K={_initBehaviors:function(){var e=this.getValue(this.getOption("behaviors"));this._behaviors=t.isObject(e)?m(this,e):{}},_getBehaviorTriggers:function(){var e=H(this._behaviors,"getTriggers");return t.extend.apply(t,[{}].concat(M.toConsumableArray(e)))},_getBehaviorEvents:function(){var e=H(this._behaviors,"getEvents");return t.extend.apply(t,[{}].concat(M.toConsumableArray(e)))},_proxyBehaviorViewProperties:function(){H(this._behaviors,"proxyViewProperties")},_delegateBehaviorEntityEvents:function(){H(this._behaviors,"delegateEntityEvents")},_undelegateBehaviorEntityEvents:function(){H(this._behaviors,"undelegateEntityEvents")},_destroyBehaviors:function(e){H.apply(void 0,[this._behaviors,"destroy"].concat(M.toConsumableArray(e)))},_bindBehaviorUIElements:function(){H(this._behaviors,"bindUIElements")},_unbindBehaviorUIElements:function(){H(this._behaviors,"unbindUIElements")},_triggerEventOnBehaviors:function(){for(var e=this._behaviors,t=arguments.length,i=Array(t),n=0;t>n;n++)i[n]=arguments[n];for(var r=0,o=e&&e.length;o>r;r++)s.apply(e[r],i)}},Y={_delegateEntityEvents:function(e,t){this._undelegateEntityEvents(e,t);var i=this.getValue(this.getOption("modelEvents"));f.call(this,e,i);var n=this.getValue(this.getOption("collectionEvents"));f.call(this,t,n)},_undelegateEntityEvents:function(e,t){var i=this.getValue(this.getOption("modelEvents"));g.call(this,e,i);var n=this.getValue(this.getOption("collectionEvents"));g.call(this,t,n)}},G=/^(\S+)\s*(.*)$/,Z=function(e){var t=e.match(G);return w(t[1],t[2])},J={_getViewTriggers:function(e,i){return t.reduce(i,function(t,i,n){return n=Z(n),t[n]=E(e,i),t},{})}},Q=function(e,i){return t.reduce(e,function(e,t,n){var r=W(n,i);return e[r]=t,e},{})},W=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(e){return t[e.slice(4)]})},X=function pe(e,i,n){return t.each(e,function(r,s){t.isString(r)?e[s]=W(r,i):t.isObject(r)&&t.isArray(n)&&(t.extend(r,pe(t.pick(r,n),i)),t.each(n,function(e){var n=r[e];t.isString(n)&&(r[e]=W(n,i))}))}),e},ee={normalizeUIKeys:function(e){var t=this._getUIBindings();return Q(e,t)},normalizeUIValues:function(e,t){var i=this._getUIBindings();return X(e,i,t)},_getUIBindings:function(){var e=t.result(this,"_uiBindings"),i=t.result(this,"ui");return e||i},_bindUIElements:function(){var e=this;if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var i=t.result(this,"_uiBindings");this._ui={},t.each(i,function(t,i){e._ui[i]=e.$(t)}),this.ui=this._ui}},_unbindUIElements:function(){var e=this;this.ui&&this._uiBindings&&(t.each(this.ui,function(t,i){delete e.ui[i]}),this.ui=this._uiBindings,delete this._uiBindings,delete this._ui)},_getUI:function(e){return this._ui[e]}},te={supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,_isDestroyed:!1,isDestroyed:function(){return!!this._isDestroyed},_isRendered:!1,isRendered:function(){return!!this._isRendered},_isAttached:!1,isAttached:function(){return!!this._isAttached},mixinTemplateContext:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=this.getValue(this.getOption("templateContext"));return t.extend(e,i)},delegateEvents:function(i){this._proxyBehaviorViewProperties(),this._buildEventProxies();var n=this._getEvents(i);"undefined"==typeof i&&(this.events=n);var r=t.extend({},this._getBehaviorEvents(),n,this._getBehaviorTriggers(),this.getTriggers());return e.View.prototype.delegateEvents.call(this,r),this},_getEvents:function(e){var t=this.getValue(e||this.events);return this.normalizeUIKeys(t)},getTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(t.result(this,"triggers"));return this._getViewTriggers(this,e)}},delegateEntityEvents:function(){return this._delegateEntityEvents(this.model,this.collection),this._delegateBehaviorEntityEvents(),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.model,this.collection),this._undelegateBehaviorEntityEvents(),this},_ensureViewIsIntact:function(){if(this._isDestroyed)throw new L({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this._isDestroyed)return this;for(var e=!!this._isAttached,t=arguments.length,i=Array(t),n=0;t>n;n++)i[n]=arguments[n];return this.triggerMethod.apply(this,["before:destroy"].concat(i)),e&&this.triggerMethod("before:detach",this),this.unbindUIElements(),this._removeElement(),e&&(this._isAttached=!1,this.triggerMethod("detach",this)),this._removeChildren(),this._destroyBehaviors(i),this._isDestroyed=!0,this._isRendered=!1,this.triggerMethod.apply(this,["destroy"].concat(i)),this.stopListening(),this},bindUIElements:function(){return this._bindUIElements(),this._bindBehaviorUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this._unbindBehaviorUIElements(),this},getUI:function(e){return this._ensureViewIsIntact(),this._getUI(e)},childViewEventPrefix:"childview",triggerMethod:function(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];var n=s.apply(this,t);return this._triggerEventOnBehaviors.apply(this,t),this._triggerEventOnParentLayout.apply(this,t),n},_buildEventProxies:function(){this._childViewEvents=this.getValue(this.getOption("childViewEvents")),this._childViewTriggers=this.getValue(this.getOption("childViewTriggers"))},_triggerEventOnParentLayout:function(e){var i=this._parentView();if(i){for(var n=i.getOption("childViewEventPrefix"),r=n+":"+e,s=arguments.length,o=Array(s>1?s-1:0),h=1;s>h;h++)o[h-1]=arguments[h];i.triggerMethod.apply(i,[r].concat(o));var a=i.normalizeMethods(i._childViewEvents);a&&t.isFunction(a[e])&&a[e].apply(i,o);var l=i._childViewTriggers;l&&t.isString(l[e])&&i.triggerMethod.apply(i,[l[e]].concat(o))}},_parentView:function(){for(var e=this._parent;e;){if(e instanceof re)return e;e=e._parent}}};t.extend(te,K,q,Y,J,ee);var ie=P.extend({cidPrefix:"mnr",replaceElement:!1,_isReplaced:!1,constructor:function(t){if(this._setOptions(t),this._initEl=this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new L({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),P.call(this,t)},show:function(e,t){return this._ensureElement(t)?(this._ensureView(e),e===this.currentView?this:(this.triggerMethod("before:show",this,e,t),d(e),this.empty(t),e.on("destroy",this.empty,this),e._parent=this,this._renderView(e),this._attachView(e,t),this.triggerMethod("show",this,e,t),this)):void 0},_renderView:function(e){e._isRendered||(e.supportsRenderLifecycle||o(e,"before:render",e),e.render(),e.supportsRenderLifecycle||(e._isRendered=!0,o(e,"render",e)))},_attachView:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=!e._isAttached&&A(this.el),n="undefined"==typeof t.replaceElement?!!this.getOption("replaceElement"):!!t.replaceElement;i&&o(e,"before:attach",e),this.attachHtml(e,n),i&&(e._isAttached=!0,o(e,"attach",e)),this.currentView=e},_ensureElement:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(t.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){var i="undefined"==typeof e.allowMissingEl?!!this.getOption("allowMissingEl"):!!e.allowMissingEl;if(i)return!1;throw new L('An "el" must exist in DOM for this region '+this.cid)}return!0},_ensureView:function(e){if(!e)throw new L({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e._isDestroyed)throw new L({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(t){return e.$(t,this.getValue(this.getOption("parentEl")))},_replaceEl:function(e){this._restoreEl();var t=this.el.parentNode;t.replaceChild(e.el,this.el),this._isReplaced=!0},_restoreEl:function(){if(this.currentView){var e=this.currentView,t=e.el.parentNode;t&&(t.replaceChild(this.el,e.el),this._isReplaced=!1)}},isReplaced:function(){return!!this._isReplaced},attachHtml:function(e,t){t?this._replaceEl(e):this.el.appendChild(e.el)},empty:function(e){var t=this.currentView;return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",this,t),this._isReplaced&&this._restoreEl(),t._isDestroyed||this._removeView(t,e),delete this.currentView._parent,delete this.currentView,this.triggerMethod("empty",this,t),this):this},_removeView:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=t.preventDestroy,n=!!i;return n?void this._detachView(e):void(e.destroy?e.destroy():b(e))},_detachView:function(e){var t=!!e._isAttached;t&&o(e,"before:detach",e),this.$el.contents().detach(),t&&(e._isAttached=!1,o(e,"detach",e))},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this._initEl),delete this.$el,this},destroy:function(){return this.reset(),P.prototype.destroy.apply(this,arguments)}}),ne={regionClass:ie,_initRegions:function(){this.regions=this.regions||{},this._regions={},this.addRegions(this.getValue(this.getOption("regions")))},_reInitRegions:function(){H(this._regions,"reset")},addRegion:function(e,t){var i={};return i[e]=t,this.addRegions(i)[e]},addRegions:function(e){return t.isEmpty(e)?void 0:(e=this.normalizeUIValues(e,["selector","el"]),this.regions=t.extend({},this.regions,e),this._addRegions(e))},_addRegions:function(e){var i=this;return t.reduce(e,function(e,t,n){return e[n]=i._buildRegion(t),i._addRegion(e[n],n),e},{})},_buildRegion:function(e){return e instanceof ie?e:this._buildRegionFromDefinition(e)},_buildRegionFromDefinition:function(e){if(t.isString(e))return this._buildRegionFromObject({el:e});if(t.isFunction(e))return this._buildRegionFromRegionClass(e);if(t.isObject(e))return this._buildRegionFromObject(e);throw new L({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromObject:function(e){var i=e.regionClass||this.getOption("regionClass"),n=t.omit(e,"regionClass");return t.defaults(n,{el:e.selector,parentEl:t.partial(t.result,this,"el")}),new i(n)},_buildRegionFromRegionClass:function(e){return new e({parentEl:t.partial(t.result,this,"el")})},_addRegion:function(e,t){this.triggerMethod("before:add:region",t,e),e._parent=this,this._regions[t]=e,this.triggerMethod("add:region",t,e)},removeRegion:function(e){var t=this._regions[e];return this._removeRegion(t,e),t},removeRegions:function(){var e=this.getRegions();return t.each(this._regions,t.bind(this._removeRegion,this)),e},_removeRegion:function(e,t){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete this.regions[t],delete this._regions[t],this.triggerMethod("remove:region",t,e)},emptyRegions:function(){var e=this.getRegions();return H(e,"empty"),e},hasRegion:function(e){return!!this.getRegion(e)},getRegion:function(e){return this._regions[e]},getRegions:function(){return t.clone(this._regions)},showChildView:function(e,t){for(var i=this.getRegion(e),n=arguments.length,r=Array(n>2?n-2:0),s=2;n>s;s++)r[s-2]=arguments[s];return i.show.apply(i,[t].concat(r))},getChildView:function(e){return this.getRegion(e).currentView}},re=e.View.extend({constructor:function(i){this.render=t.bind(this.render,this),this._setOptions(i),d(this),this._initBehaviors(),this._initRegions(),e.View.prototype.constructor.call(this,this.options),this.delegateEntityEvents()},serializeData:function(){return this.model||this.collection?this.model?this.serializeModel():{items:this.serializeCollection()}:{}},serializeModel:function(){return this.model?t.clone(this.model.attributes):{}},serializeCollection:function(){return this.collection?this.collection.map(function(e){return t.clone(e.attributes)}):{}},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._isRendered&&this._reInitRegions(),this._renderTemplate(),this.bindUIElements(),this._isRendered=!0,this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){var t=this.mixinTemplateContext(this.serializeData()),i=N.render(e,t,this);this.attachElContent(i)}},getTemplate:function(){return this.getOption("template")},attachElContent:function(e){return this.$el.html(e),this},_removeChildren:function(){this.removeRegions()},_getImmediateChildren:function(){return t.chain(this.getRegions()).map("currentView").compact().value()}});t.extend(re.prototype,te,ne);var se=e.View.extend({sort:!0,constructor:function(i){this.render=t.bind(this.render,this),this._setOptions(i),d(this),this._initBehaviors(),this.once("render",this._initialEvents),this._initChildViewStorage(),this._bufferedChildren=[],e.View.prototype.constructor.call(this,this.options),this.delegateEntityEvents()},_startBuffering:function(){this._isBuffering=!0},_endBuffering:function(){var e=!!this._isAttached,i=e?this._getImmediateChildren():[];this._isBuffering=!1,t.each(i,function(e){o(e,"before:attach",e)}),this.attachBuffer(this,this._createBuffer()),t.each(i,function(e){e._isAttached=!0,o(e,"attach",e)}),this._bufferedChildren=[]},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,i,n){var r=void 0!==n.at&&(n.index||i.indexOf(e));if((this.getOption("filter")||r===!1)&&(r=t.indexOf(this._filteredSortedModels(r),e)),this._shouldAddChild(e,r)){this._destroyEmptyView();var s=this._getChildView(e);this._addChild(e,s,r)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this._removeChildView(t),this._checkEmpty()},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this._isRendered=!0,this.triggerMethod("render",this),this},setFilter:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=t.preventRender,n=this._isRendered&&!this._isDestroyed,r=this.filter!==e,s=n&&r&&!i;if(s){this.triggerMethod("before:apply:filter",this);var o=this._filteredSortedModels();this.filter=e;var h=this._filteredSortedModels();this._applyModelDeltas(h,o),this.triggerMethod("apply:filter",this)}else this.filter=e},removeFilter:function(e){this.setFilter(null,e)},_applyModelDeltas:function(e,i){var n=this,r={};t.each(e,function(e,t){var i=!n.children.findByModel(e);i&&n._onCollectionAdd(e,n.collection,{at:t}),r[e.cid]=!0}),t.each(i,function(e){var t=!r[e.cid]&&n.children.findByModel(e);t&&n._onCollectionRemove(e)})},reorder:function(){var e=this,i=this.children,n=this._filteredSortedModels(),r=t.some(n,function(e){return!i.findByModel(e)});r?this.render():!function(){var r=t.map(n,function(e,t){var n=i.findByModel(e);return n._index=t,n.el}),s=i.filter(function(e){return!t.contains(r,e.el)});e.triggerMethod("before:reorder",e),e._appendReorderedChildren(r),t.each(s,t.bind(e._removeChildView,e)),e._checkEmpty(),e.triggerMethod("reorder",e)}()},resortView:function(){this.getOption("reorderOnSort")?this.reorder():this._renderChildren()},_sortViews:function(){var e=this,i=this._filteredSortedModels(),n=t.find(i,function(t,i){var n=e.children.findByModel(t);return!n||n._index!==i});n&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this._destroyEmptyView(),this._destroyChildren({checkEmpty:!1});var e=this._filteredSortedModels();this.isEmpty({processedModels:e})?this._showEmptyView():(this.triggerMethod("before:render:children",this),this._startBuffering(),this._showCollection(e),this._endBuffering(),this.triggerMethod("render:children",this))},_showCollection:function(e){var i=this;t.each(e,function(e,t){var n=i._getChildView(e);i._addChild(e,n,t)})},_filteredSortedModels:function(e){if(!this.collection)return[];var t=this.getViewComparator(),i=this.collection.models;if(e=Math.min(Math.max(e,0),i.length-1),t){var n=void 0;e&&(n=i[e],i=i.slice(0,e).concat(i.slice(e+1))),i=this._sortModelsBy(i,t),n&&i.splice(e,0,n)}return i=this._filterModels(i)},_filterModels:function(e){var i=this;return this.getOption("filter")&&(e=t.filter(e,function(e,t){return i._shouldAddChild(e,t)})),e},_sortModelsBy:function(e,i){return"string"==typeof i?t.sortBy(e,function(e){return e.get(i)}):1===i.length?t.sortBy(e,t.bind(i,this)):e.sort(t.bind(i,this))},_showEmptyView:function(){var i=this.getEmptyView();if(i&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new e.Model,r=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");t.isFunction(r)&&(r=r.call(this,n,this._emptyViewIndex));var s=this._buildChildView(n,i,r);this.triggerMethod("before:render:empty",this,s),this._addChildView(s,0),this.triggerMethod("render:empty",this,s),s._parent=this}},_destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty",this),this._destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty",this))},getEmptyView:function(){return this.getOption("emptyView")},_getChildView:function(i){var n=this.getOption("childView");if(!n)throw new L({name:"NoChildViewError",message:'A "childView" must be specified'});if(n.prototype instanceof e.View||n===e.View)return n;if(t.isFunction(n))return n.call(this,i);throw new L({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'})},_addChild:function(e,t,i){var n=this.getValue(this.getOption("childViewOptions"),e,i),r=this._buildChildView(e,t,n);return this._updateIndices(r,!0,i),this.triggerMethod("before:add:child",this,r),this._addChildView(r,i),this.triggerMethod("add:child",this,r),r._parent=this,r},_updateIndices:function(e,t,i){this.getOption("sort")&&(t&&(e._index=i),this.children.each(function(i){i._index>=e._index&&(i._index+=t?1:-1)}))},_addChildView:function(e,t){var i=!this._isBuffering&&this._isAttached;this._proxyChildEvents(e),this.children.add(e),e.supportsRenderLifecycle||o(e,"before:render",e),e.render(),e.supportsRenderLifecycle||(e._isRendered=!0,o(e,"render",e)),i&&o(e,"before:attach",e),this.attachHtml(this,e,t),i&&(e._isAttached=!0,o(e,"attach",e))},_buildChildView:function(e,i,n){var r=t.extend({model:e},n),s=new i(r);return d(s),s},_removeChildView:function(e){e&&!e._isDestroyed&&(this.triggerMethod("before:remove:child",this,e),e.destroy?e.destroy():b(e),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",this,e),this._updateIndices(e,!1))},isEmpty:function(e){var i=void 0;return t.result(e,"processedModels")?i=e.processedModels:(i=this.collection?this.collection.models:[],i=this._filterModels(i)),0===i.length},_checkEmpty:function(){this.isEmpty()&&this._showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return t.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,i){e._isBuffering?e._bufferedChildren.splice(i,0,t):e._insertBefore(t,i)||e._insertAfter(t)},_insertBefore:function(e,t){var i=void 0,n=this.getOption("sort")&&t<this.children.length-1;return n&&(i=this.children.find(function(e){return e._index===t+1})),i?(i.$el.before(e.el),!0):!1},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new n},_removeChildren:function(){this._destroyChildren({checkEmpty:!1})},_destroyChildren:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=e.checkEmpty;this.triggerMethod("before:destroy:children",this);var n=i!==!1,r=this.children.map(t.identity);return this.children.each(t.bind(this._removeChildView,this)),n&&this._checkEmpty(),this.triggerMethod("destroy:children",this),r},_shouldAddChild:function(e,i){var n=this.getOption("filter");return!t.isFunction(n)||n.call(this,e,i,this.collection);
},_proxyChildEvents:function(e){var i=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(e){for(var n=i+":"+e,r=this.normalizeMethods(this._childViewEvents),s=arguments.length,o=Array(s>1?s-1:0),h=1;s>h;h++)o[h-1]=arguments[h];"undefined"!=typeof r&&t.isFunction(r[e])&&r[e].apply(this,o);var a=this._childViewTriggers;a&&t.isString(a[e])&&this.triggerMethod.apply(this,[a[e]].concat(o)),this.triggerMethod.apply(this,[n].concat(o))})},_getImmediateChildren:function(){return t.values(this.children._views)},getViewComparator:function(){return this.getOption("viewComparator")}});t.extend(se.prototype,te);var oe=se.extend({constructor:function(){U("CompositeView is deprecated. Convert to View at your earliest convenience"),se.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_getChildView:function(i){var n=this.getOption("childView");if(n){if(n.prototype instanceof e.View||n===e.View)return n;if(t.isFunction(n))return n.call(this,i);throw new L({name:"InvalidChildViewError",message:'"childView" must be a view class or a function that returns a view class'})}return this.constructor},serializeData:function(){return this.serializeModel()},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.renderChildren(),this._isRendering=!1,this._isRendered=!0,this.triggerMethod("render",this),this},renderChildren:function(){(this._isRendered||this._isRendering)&&se.prototype._renderChildren.call(this)},attachBuffer:function(e,t){var i=this.getChildViewContainer(e);i.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e,t){if(e.$childViewContainer)return e.$childViewContainer;var i=void 0,n=T.call(e,"childViewContainer");if(n){var r=S.call(e,n);if(i="@"===r.charAt(0)&&e.ui?e.ui[r.substr(4)]:e.$(r),i.length<=0)throw new L({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else i=e.$el;return e.$childViewContainer=i,i},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),he=t.pick(re.prototype,"serializeModel","getTemplate","_renderTemplate","attachElContent");t.extend(oe.prototype,he);var ae=P.extend({cidPrefix:"mnb",constructor:function(e,i){this.view=i,this.defaults=t.clone(t.result(this,"defaults",{})),this._setOptions(this.defaults,e),this.ui=t.extend({},t.result(this,"ui"),t.result(i,"ui")),P.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(){return this.$el=this.view.$el,this.el=this.view.el,this},bindUIElements:function(){return this._bindUIElements(),this},unbindUIElements:function(){return this._unbindUIElements(),this},getUI:function(e){return this.view._ensureViewIsIntact(),this._getUI(e)},delegateEntityEvents:function(){return this._delegateEntityEvents(this.view.model,this.view.collection),this},undelegateEntityEvents:function(){return this._undelegateEntityEvents(this.view.model,this.view.collection),this},getEvents:function(){var e=this.normalizeUIKeys(t.result(this,"events"));return t.reduce(e,function(e,i,n){return t.isFunction(i)||(i=this[i]),i?(n=Z(n),e[n]=t.bind(i,this),e):void 0},{},this)},getTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(t.result(this,"triggers"));return this._getViewTriggers(this.view,e)}}});t.extend(ae.prototype,Y,J,ee);var le=P.extend({cidPrefix:"mna",constructor:function(e){this._setOptions(e),this._initRegion(),P.prototype.constructor.apply(this,arguments)},regionClass:ie,_initRegion:function(e){var i=this.getOption("region"),n=this.getOption("regionClass");return t.isString(i)?void(this._region=new n({el:i})):void(this._region=i)},getRegion:function(){return this._region},showView:function(e){for(var t=this.getRegion(),i=arguments.length,n=Array(i>1?i-1:0),r=1;i>r;r++)n[r-1]=arguments[r];return t.show.apply(t,[e].concat(n))},getView:function(){return this.getRegion().currentView},start:function(e){this.triggerMethod("before:start",e),this.triggerMethod("start",e)}}),de=e.Router.extend({constructor:function(t){this._setOptions(t),e.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var i=this._getController();this._addAppRoute(i,e,t)},_processOnRoute:function(e,i){if(t.isFunction(this.onRoute)){var n=t.invert(this.getOption("appRoutes"))[e];this.onRoute(e,n,i)}},processAppRoutes:function(e,i){var n=this;if(i){var r=t.keys(i).reverse();t.each(r,function(t){n._addAppRoute(e,t,i[t])})}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,i,n){var r=e[n];if(!r)throw new L('Method "'+n+'" was not found on the controller');this.route(i,n,t.bind(r,e))},triggerMethod:s});t.extend(de.prototype,q);var ce={},ue=e.Marionette,fe=e.Marionette={};return fe.noConflict=function(){return e.Marionette=ue,this},fe.bindEntityEvents=B(f),fe.unbindEntityEvents=B(g),fe.bindRadioEvents=B(f),fe.unbindRadioEvents=B(g),fe.bindRadioRequests=B(_),fe.unbindRadioRequests=B(v),fe.mergeOptions=B(I),fe.getOption=B(T),fe.normalizeMethods=B(D),fe.extend=O,fe.isNodeAttached=A,fe.deprecate=U,fe.triggerMethod=B(s),fe.triggerMethodOn=o,fe.isEnabled=C,fe.setEnabled=R,fe.monitorViewEvents=d,fe.Behaviors={},fe.Behaviors.behaviorsLookup=V,fe.Application=le,fe.AppRouter=de,fe.Renderer=N,fe.TemplateCache=j,fe.View=re,fe.CollectionView=se,fe.CompositeView=oe,fe.Behavior=ae,fe.Region=ie,fe.Error=L,fe.Object=P,fe.DEV_MODE=!1,fe.FEATURES=ce,fe.VERSION=x,fe}(Backbone,_,Backbone.Radio,Backbone.ChildViewContainer);
//# sourceMappingURL=backbone.marionette.min.js.map
